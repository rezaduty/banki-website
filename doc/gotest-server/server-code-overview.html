

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>بررسی کد سرور &mdash; نوبت دهی غیر حضوری بانک Banki v0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    
  

  

  
  
    

  

  
  
          <link href='http://www.fontonline.ir/css/BYekan.css' rel='stylesheet' type='text/css'>
<style>
  *{
  font-family:'BYekan',Sans-Serif;
 }
 h1,h2,h3,h4,h5,h6{
    font-family:'BYekan',Sans-Serif !important;

 }
 p{
    font-family:'BYekan',Sans-Serif;
    font-size: 17px;
 }
 .caption-text{
  color: #2980b9;
 }
 .wy-menu-vertical{
  width: 291px !important;
 }
 .wy-nav-content{
  max-width: 100% !important;
 }
 pre{
   direction: ltr !important;
 }
</style>
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/syncthing.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="نوبت دهی غیر حضوری بانک Banki v0.1 documentation" href="../index.html"/>
        <link rel="next" title="نوبت دهی از طریق وبسایت چگونه است ؟" href="../gotest-webapp/webapp-overview.html"/>
        <link rel="prev" title="بررسی سرور قسمت ۲" href="server-overview2.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>
  <style type="text/css">
      .menui {
      background: #fff;
      transition: 0.6s ease;
      transition-timing-function: cubic-bezier(.75, 0, .29, 1.01);
      margin-top: 10px;
      position: absolute;
    }

    .icon1 {
      z-index: 999;
      position: fixed;
      display: block;
      padding: 9px;
      height: 32px;
      width: 32px;
      margin: 0px;
      top: 0;
      left: 2%;
    }

@media (min-width : 320px) {
  .icon1{
    top: 3%;
    left: 7%;
  }
}

    .mobilenav {
      font-family: inherit;
      top: 0;
      left: 0;
      z-index: 999;
      display: none;
      position: fixed;
      width: 100%;
      height: 100%;
      background: rgba(0, 153, 153, 0.7);
      opacity: 0.9;
    }

    .mobilenav li {
      list-style-type: none;
      text-align: center;
      padding: 10px;
    }

    .mobilenav li a {
      font-size: 150%;
      color: #fff;
      text-decoration: none;
      font-weight: 300;
      width: 100%;
    }

    .mobilenav li:first-child { margin-top: 60px; }

    .top-animate {
      background: #fff !important;
      top: 13px !important;
      -webkit-transform: rotate(45deg);
      transform: rotate(45deg);
    }

    .mid-animate { opacity: 0; }

    .bottom-animate {
      background: #fff !important;
      top: 13px !important;
      -webkit-transform: rotate(-225deg);
      transform: rotate(-225deg);
    }

    .top-menu {
      top: 5px;
      width: 25px;
      height: 2px;
      border-radius: 10px;
      background-color: #0070b9;
    }

    .mid-menu {
      top: 13px;
      width: 25px;
      height: 2px;
      border-radius: 10px;
      background-color: #0070b9;
    }

    .bottom-menu {
      top: 21px;
      width: 25px;
      height: 2px;
      border-radius: 10px;
      background-color: #0070b9;
    }
    
  </style>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> نوبت دهی غیر حضوری بانک Banki
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="جست و جو" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">راه اندازی</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gotest-run/server-run.html">راه اندازی پروژه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gotest-run/server-run.html#id2">راه اندازی سرور</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-run/server-run.html#id5">راه اندازی بانک ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-run/server-run.html#id6">راه اندازی بات</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">مقدمه</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html">به چه دردی میخورد ؟</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html#id2">آیا استفاده از آن آسان است ؟</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html#id3">سخنی با بانک داران</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html#id4">سیستم نوبت دهی چیست ؟</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html#id5">سیستم نوبت‌دهی بی‌سیم</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html#id6">نوبت دهی پیامکی چیست؟</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about-project.html#id7">کیوسک نوبت دهی یا استند نوبت دهی چیست؟</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/about-project.html#id8">منابع</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">هسته - سرور</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithm-overview.html">بررسی الگوریتم ؟</a></li>
<li class="toctree-l1"><a class="reference internal" href="server-overview1.html">بررسی سرور قسمت ۱</a><ul>
<li class="toctree-l2"><a class="reference internal" href="server-overview1.html#http-rest">از HTTP و REST چه می دانید ؟</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#rest">REST چیست ؟</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#http">HTTP چیست ؟</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#id2">HTTP را جاسوسی کنید !</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#url">URL چیست ؟</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#id3">عملیات های مختلف HTTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#get">GET</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#put">PUT</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#delete">DELETE</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#post">POST</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="server-overview1.html#rest-api">REST API چیست و چگونه کار می کند ؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview1.html#soap-restful">تفاوت وب سرویس های SOAP و  RESTful چیست؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview1.html#restful-rest">RESTful یا REST بودن یک وب سایت به چه معناست؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview1.html#json">مدل داده JSON</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#id4">خصوصیات JSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="server-overview1.html#id5">منابع</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server-overview2.html">بررسی سرور قسمت ۲</a><ul>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-golang">آشنایی با زبان برنامه نویسی Go یا Golang</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server-overview2.html#id2">چرا گو ?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go">Go یک زبان مدرن و همه منظوره است</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id3">Go یک زبان (آزاد) و متن باز است</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id4">Go یک زبان کامپایل شونده است</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-syntax">Go و Syntax آشنا</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-procedural">Go یک زبان رویه‌ای است (Procedural)</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id5">ابتدا یک توضیح ساده در باره کلاس‌ها و اشیا</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-class-struct">Go به جای Class از Struct استفاده می‌کند</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-composition">Go از Composition به جای وراثت استفاده می‌کند</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-static-type">Go یک زبان Static-Type است</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-concurrency">Go و Concurrency:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server-overview2.html#coroutine-thread">Coroutine‌ها چندین فرق اساسی با Thread‌ها دارند:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#go-functional">Go و قابلیت‌های Functional</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#closure">توضیح درباره Closure ها:</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id6">قابلیت‌های نداشته، قابلیت اصلی زبان Go</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id7">نواقص زبان برنامه نویسی Go</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id8">از کجا کار با Go را شروع کنیم؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="server-overview2.html#id9">کاربرد زبان برنامه نویسی Go کجاست؟</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server-overview2.html#id10">منابع</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">بررسی کد سرور</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">ساختار پروژه</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">بررسی فایل های پروژه</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logger-go">logger.go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-go">error.go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handlers-go">handlers.go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#repo-go">repo.go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#router-go">router.go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#routes-go">routes.go</a></li>
<li class="toctree-l3"><a class="reference internal" href="#todo-go">todo.go</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#main-go">main.go</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">رابط کاربری - وبسایت</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gotest-webapp/webapp-overview.html">نوبت دهی از طریق وبسایت چگونه است ؟</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#id2">صفحه اصلی</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#id3">ثبت نام</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#id4">بررسی کد و ساختار</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#id5">بررسی  ساختار پوشه ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#id6">بررسی کد های مربوطه</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#index-html">index.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gotest-webapp/webapp-overview.html#gotest-logup-html">gotest.logup.html</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">رابط کاربری - ربات</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gotest-bot/bot-overview.html">نوبت دهی از طریق ربات</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gotest-bot/bot-overview.html#id2">نوبت دهی از طریق ربات چگونه است ؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-bot/bot-overview.html#id4">بررسی کد</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gotest-bot/bot-overview.html#colorer-py">Colorer.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gotest-bot/bot-overview.html#telegrambot-py">telegrambot.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">گزارشات</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gotest-benchmark/intro-benchmark.html">سرعت سیستم چگونه است</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gotest-benchmark/intro-benchmark.html#id2">برنامه تست</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">دستگاه شبیه ساز نوبت دهی غیر حضوری</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gotest-simulation/simul-information.html">مشخصات دستگاه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gotest-simulation/simul-information.html#id2">اندازه و نوع بنده دستگاه</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-simulation/simul-information.html#id3">قطعات به کار رفته در دستگاه</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gotest-simulation/simul-overview.html">بررسی دستگاه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gotest-simulation/simul-overview.html#id2">بررسی مدار</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gotest-simulation/simul-overview.html#id3">بررسی کد</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">نوبت دهی غیر حضوری بانک Banki</a>
      </nav>



      
      <!-- left menu -->
      <div class="wy-nav-content">
        <div class="mobilenav"> 
          <li><a target="_blank" href="#">Website</a></li> 
          <li><a target="_blank" href="#">App</a></li> 
          <li><a target="_blank" href="#">Telegram Bot</a></li> 
        </div>
        <a href="javascript:void(0)" class="icon1">
          <div class="hamburger">
            <div class="menui top-menu"></div>
            <div class="menui mid-menu"></div>
            <div class="menui bottom-menu"></div>
          </div>
        </a>

        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">مستندات</a> &raquo;</li>
      
    <li>بررسی کد سرور</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/gotest-server/server-code-overview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="server-code-overview">
<span id="id1"></span><h1>بررسی کد سرور<a class="headerlink" href="#server-code-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>ساختار پروژه<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>پروژه از پروژه متن باز دیگری که در <a class="reference external" href="https://thenewstack.io/make-a-restful-json-api-go/">این</a> لینک درباره آن صحبت شده است ساخته شده است</p>
<p>و همچنین از v۹ این پروژه fork شده است که در تصویر ساختار آن را مشاهده میکنید</p>
<p><a class="reference external" href="https://github.com/corylanou/tns-restful-json-api/tree/master/v9/">لینک گیت هاب</a></p>
<img alt="../_images/tns_v9.png" src="../_images/tns_v9.png" />
<p>پس از تغیرات و به خوانایی بهتر ساختار پروژه به این شکل تغیر کرد</p>
<img alt="../_images/folder_structure.jpg" src="../_images/folder_structure.jpg" />
<p>همچنین ساختار دیتابیس نیز بدین شهر است</p>
<img alt="../_images/db.png" src="../_images/db.png" />
<p>که به صورت تفصیلی در بررسی الگوریتم درباره آن صحبت شده است</p>
</div>
<div class="section" id="id5">
<h2>بررسی فایل های پروژه<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/dir.png" src="../_images/dir.png" />
<p>برای لاگ های پروژه بر روی cli</p>
<div class="section" id="logger-go">
<h3>logger.go<a class="headerlink" href="#logger-go" title="Permalink to this headline">¶</a></h3>
<p>چون در فولدر  log هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">log</span>
</pre></div>
</div>
<p>کتابخوانه های فراخوانی شده هم شامل این مقادیر است</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
    <span class="s">&quot;time&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>تابعی که هر درخوات به وبسرویس را با مشخصات زیر لاگ میکند</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">Logger</span><span class="p">(</span><span class="nx">inner</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span><span class="p">,</span> <span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">http</span><span class="p">.</span><span class="nx">HandlerFunc</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">start</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">()</span>

        <span class="nx">inner</span><span class="p">.</span><span class="nx">ServeHTTP</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
        <span class="c1">// چاپ لاگ</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span>
            <span class="c1">// با این فرمت نمایش میدهد</span>
            <span class="s">&quot;%s\t%s\t%s\t%s\t%s&quot;</span><span class="p">,</span>
            <span class="c1">// متد درخواست مثلا GET</span>
            <span class="nx">r</span><span class="p">.</span><span class="nx">Method</span><span class="p">,</span>
            <span class="c1">// آدرس درخواست شده</span>
            <span class="nx">r</span><span class="p">.</span><span class="nx">RequestURI</span><span class="p">,</span>
            <span class="c1">// نام تابع صدا زده شده</span>
            <span class="nx">name</span><span class="p">,</span>
            <span class="c1">// زمان درخواست اطلاعات</span>
            <span class="nx">time</span><span class="p">.</span><span class="nx">Since</span><span class="p">(</span><span class="nx">start</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="error-go">
<h3>error.go<a class="headerlink" href="#error-go" title="Permalink to this headline">¶</a></h3>
<p>فایلی جدا برای گرفتن نمونه با ساختار مشخص برای خطا یابی</p>
<p>چون در فولدر  router هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">route</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// ساخت ساختار مشخصی با نام jsonErr</span>
<span class="kd">type</span> <span class="nx">jsonErr</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Code</span> <span class="kt">int</span>    <span class="s">`json:&quot;code&quot;`</span>
    <span class="c1">// کد خطا از نوع json:code</span>
    <span class="nx">Text</span> <span class="kt">string</span> <span class="s">`json:&quot;text&quot;`</span>
    <span class="c1">// متن خطا از نوع json:text</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="handlers-go">
<h3>handlers.go<a class="headerlink" href="#handlers-go" title="Permalink to this headline">¶</a></h3>
<p>چون در فولدر  router هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">route</span>
</pre></div>
</div>
<p>کتابخوانه های فراخوانی شده هم شامل این مقادیر است</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;database/sql&quot;</span>
    <span class="s">&quot;encoding/json&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="nx">_</span> <span class="s">&quot;github.com/go-sql-driver/mysql&quot;</span>
    <span class="s">&quot;github.com/gorilla/mux&quot;</span>
    <span class="s">&quot;io&quot;</span>
    <span class="s">&quot;io/ioutil&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
    <span class="s">&quot;strconv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>با توجه به مسیر نوشته شده مسیر پیش فرض به این تابع هدایت میشود</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">Index</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;Welcome To Gotest!\n&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>برای نشان دادن همه ی افراد داخل پایگاه داده از این تابع استفاده میشود</p>
<p>همچنین با این دستور میتوانید آن را تست کنید</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// User Scope</span>
<span class="kd">func</span> <span class="nx">UserShow</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;UserShow()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
    <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
    <span class="nx">getUser</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT * from tbl_user&quot;</span><span class="p">)</span>
    <span class="c1">// query برای نشان دادن تمامی افراد جدول user</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
        <span class="c1">// چک کردن خروجی و در صورت اررو چاپ خطا</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getUser</span><span class="p">)</span>
    <span class="c1">// در نهایت خروجی مورد نظر چاپ شود</span>
<span class="p">}</span>
</pre></div>
</div>
<p>نمایش فردی خاص بر اساس شماره تلفن ارسالی به وبسرویس</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">UserShowById</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;UserShowById()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="nx">vars</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
    <span class="c1">// برای گرفتن مقادیر ارسالی از متغیر r که توسط کتابخوانه mux به یک آرایه با اندیس های ارسالی تبدیل میشود</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
    <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
    <span class="nx">getUserbyid</span><span class="p">,</span> <span class="nx">err_user_id</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT * from tbl_user where phone_number=&quot;</span><span class="o">+</span> <span class="nx">vars</span><span class="p">[</span><span class="s">&quot;userNumber&quot;</span><span class="p">])</span>
    <span class="c1">// query برای نشان دادن افراد با شرط اینکه شماره تلفن فرد با مقدار ارسالی  به وبسرویس یکسان باشد</span>
    <span class="k">if</span> <span class="nx">err_user_id</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err_user_id</span><span class="p">)</span>
        <span class="c1">// چک کردن خروجی و در صورت اررو چاپ خطا</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getUserbyid</span><span class="p">)</span>
    <span class="c1">// در نهایت خروجی مورد نظر چاپ شود</span>

<span class="p">}</span>
</pre></div>
</div>
<p>ثبت کاربری در پایگاه داده</p>
<p>همچنین با این دستور میتوانید آن را تست کنید</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">UserCreate</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;UserCreate()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="kd">var</span> <span class="nx">todo</span> <span class="nx">Todo</span>
    <span class="c1">// برای ثبت کاربر در پایگاه داده از ساختار از پیش نوشته شده که شامل فیلد های پایگاه داده است استفاده میکنیم</span>
    <span class="nx">body</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">io</span><span class="p">.</span><span class="nx">LimitReader</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">Body</span><span class="p">,</span> <span class="mi">1048576</span><span class="p">))</span>
    <span class="c1">// ساخت ساختار مورد نظر برای ثبت</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="c1">// چک کردن اینکه آیا فایل بسته شده است یا خیر</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">Close</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="c1">// چک کردن خروجی در صورت ناهمخوانی فیلد و مقادیر</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">todo</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
        <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">422</span><span class="p">)</span> <span class="c1">// unprocessable entity</span>
        <span class="c1">// پیوست کردن کد 422 برای اینکه مقادری هماهنگی ندارند</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nx">Encode</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
             <span class="c1">// نمایش خطا برای خطا یابی</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">t</span> <span class="o">:=</span> <span class="nx">RepoCreateUser</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span>
    <span class="c1">// ارسال ساختار صحیح به فایل repo.go و ایجاد کاربر در پایگاه داده</span>


    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="c1">// پیوست کردن کد 200 در صورت موفقیت آمیز بودن عملیات</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nx">Encode</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="c1">// پیوست کردن کد 500 در صورت خطا در  عملیات</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>برای نمایش بانک های موجود در پایگاه داده</p>
<p>همچنین با این دستور میتوانید آن را تست کنید</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Bank Scope</span>
<span class="kd">func</span> <span class="nx">BankShow</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;BankShow()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
    <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
    <span class="nx">getBank</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT * from tbl_bank&quot;</span><span class="p">)</span>
    <span class="c1">// query برای نشان دادن تمامی بانک جدول bank</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
        <span class="c1">// چک کردن خروجی و در صورت اررو چاپ خطا</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
         <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getBank</span><span class="p">)</span>
    <span class="c1">// در نهایت خروجی مورد نظر چاپ شود</span>

<span class="p">}</span>
</pre></div>
</div>
<p>برای نمایش بانک خاص بر اساس کد بانک مورد نظر</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">BankShowById</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;BankShowById()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="nx">vars</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
    <span class="c1">// برای گرفتن مقادیر ارسالی از متغیر r که توسط کتابخوانه mux به یک آرایه با اندیس های ارسالی تبدیل میشود</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
    <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
    <span class="nx">getBankbyid</span><span class="p">,</span> <span class="nx">err_bank_id</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT * from tbl_bank where bank_id=&quot;</span> <span class="o">+</span>  <span class="nx">vars</span><span class="p">[</span><span class="s">&quot;bankId&quot;</span><span class="p">])</span>
    <span class="c1">// query برای نشان دادن بانک با شرط اینکه کد بانک با مقدار ارسالی  به وبسرویس یکسان باشد</span>
    <span class="k">if</span> <span class="nx">err_bank_id</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err_bank_id</span><span class="p">)</span>
        <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getBankbyid</span><span class="p">)</span>
    <span class="c1">// در نهایت خروجی مورد نظر چاپ شود</span>

<span class="p">}</span>
</pre></div>
</div>
<p>برای ثبت بانک در پایگاه داده</p>
<p>همچنین با این دستور میتوانید آن را تست کنید</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">BankCreate</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;BankCreate()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="kd">var</span> <span class="nx">bank</span> <span class="nx">Bank</span>
    <span class="c1">// برای ثبت کاربر در پایگاه داده از ساختار از پیش نوشته شده که شامل فیلد های پایگاه داده است استفاده میکنیم</span>
    <span class="nx">body</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">io</span><span class="p">.</span><span class="nx">LimitReader</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">Body</span><span class="p">,</span> <span class="mi">1048576</span><span class="p">))</span>
    <span class="c1">// ساخت ساختار مورد نظر برای ثبت</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="c1">// چک کردن اینکه آیا فایل بسته شده است یا خیر</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">Close</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="c1">// چک کردن خروجی در صورت ناهمخوانی فیلد و مقادیر</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">bank</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
        <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
        <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">422</span><span class="p">)</span> <span class="c1">// unprocessable entity</span>
        <span class="c1">// پیوست کردن کد 422 برای اینکه مقادری هماهنگی ندارند</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nx">Encode</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
            <span class="c1">// نمایش خطا برای خطا یابی</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">b</span> <span class="o">:=</span> <span class="nx">RepoCreateBank</span><span class="p">(</span><span class="nx">bank</span><span class="p">)</span>
     <span class="c1">// ارسال ساختار صحیح به فایل repo.go و ایجاد بانک در پایگاه داده</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusCreated</span><span class="p">)</span>
    <span class="c1">// پیوست کردن وضیعت ثبت صحیح در صورت موفقیت آمیز بودن عملیات</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">NewEncoder</span><span class="p">(</span><span class="nx">w</span><span class="p">).</span><span class="nx">Encode</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>تابعی برای خواندن اطلاعات از پایگاه داده و نمایش به صورت json</p>
<p>برای اطلاعات بیشتر به لینک زیر مراجعه نمایید</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/19991541/dumping-mysql-tables-to-json-with-go">https://stackoverflow.com/questions/19991541/dumping-mysql-tables-to-json-with-go</a></p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// call by other function</span>
<span class="kd">func</span> <span class="nx">getJSON</span><span class="p">(</span><span class="nx">sqlString</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">sql</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;mysql&quot;</span><span class="p">,</span> <span class="s">&quot;root:password@tcp(127.0.0.1:3306)/tr_db&quot;</span><span class="p">)</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="nx">rows</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Query</span><span class="p">(</span><span class="nx">sqlString</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
    <span class="nx">columns</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">Columns</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="nx">count</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="nx">columns</span><span class="p">)</span>
    <span class="nx">tableData</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{},</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nx">values</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kd">interface</span><span class="p">{},</span> <span class="nx">count</span><span class="p">)</span>
    <span class="nx">valuePtrs</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kd">interface</span><span class="p">{},</span> <span class="nx">count</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">count</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
            <span class="nx">valuePtrs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="nx">rows</span><span class="p">.</span><span class="nx">Scan</span><span class="p">(</span><span class="nx">valuePtrs</span><span class="o">...</span><span class="p">)</span>
        <span class="nx">entry</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span>
        <span class="k">for</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">col</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">columns</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">v</span> <span class="kd">interface</span><span class="p">{}</span>
            <span class="nx">val</span> <span class="o">:=</span> <span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
            <span class="nx">b</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">val</span><span class="p">.([]</span><span class="kt">byte</span><span class="p">)</span>
            <span class="k">if</span> <span class="nx">ok</span> <span class="p">{</span>
                <span class="nx">v</span> <span class="p">=</span> <span class="nb">string</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">v</span> <span class="p">=</span> <span class="nx">val</span>
            <span class="p">}</span>
            <span class="nx">entry</span><span class="p">[</span><span class="nx">col</span><span class="p">]</span> <span class="p">=</span> <span class="nx">v</span>
        <span class="p">}</span>
        <span class="nx">tableData</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">tableData</span><span class="p">,</span> <span class="nx">entry</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nx">jsonData</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">tableData</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">string</span><span class="p">(</span><span class="nx">jsonData</span><span class="p">),</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
<p>برای گرفتن نوبت</p>
<p>همچنین با این دستور میتوانید آن را تست کنید</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>-<span class="o">]</span> First <span class="k">for</span> bank_id
<span class="o">[</span>-<span class="o">]</span> Second <span class="k">for</span> user_id

curl http://localhost:8088/addqueue/2/1
</pre></div>
</div>
<p>برای پیش بردن صف بانک</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span>   <span class="kd">func</span> <span class="nx">RunQueue</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;RunQueue()&quot;</span><span class="p">)</span>
       <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
       <span class="nx">vars</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
        <span class="c1">// برای گرفتن مقادیر ارسالی از متغیر r که توسط کتابخوانه mux به یک آرایه با اندیس های ارسالی تبدیل میشود</span>
       <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
       <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
       <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
       <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
       <span class="c1">// bank id should be set by client</span>
       <span class="nx">getBank</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT active_turns_number from tbl_bank WHERE bank_id=&quot;</span> <span class="o">+</span> <span class="nx">vars</span><span class="p">[</span><span class="s">&quot;bankId&quot;</span><span class="p">])</span>
       <span class="c1">// query برای نشان دادن افراد فعال داخل صف بانک با شرط اینکه کد بانک با مقدار ارسالی  به وبسرویس یکسان باشد</span>
       <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
           <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
           <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
           <span class="c1">// نمایش خطا برای خطا یابی</span>
       <span class="p">}</span>
       <span class="c1">// query برای نشان دادن تعداد افراد صف بانک با شرط اینکه کد بانک با مقدار ارسالی  به وبسرویس یکسان باشد</span>
       <span class="nx">getBank2</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT turns_number from tbl_bank WHERE bank_id=&quot;</span> <span class="o">+</span> <span class="nx">vars</span><span class="p">[</span><span class="s">&quot;bankId&quot;</span><span class="p">])</span>
       <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
           <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
           <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
           <span class="c1">// نمایش خطا برای خطا یابی</span>
       <span class="p">}</span>
       <span class="c1">// جدا کردن تعداد افراد فعال داخل صف از آرایه</span>
       <span class="nx">g1</span><span class="p">,</span><span class="nx">err</span><span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">ParseInt</span><span class="p">(</span><span class="nx">getBank</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">getBank</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">)</span>
       <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">{</span>
           <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
           <span class="c1">// نمایش خطا برای خطا یابی</span>
       <span class="p">}</span>
       <span class="c1">// جدا کردن تعداد افراد صف از آرایه</span>
       <span class="nx">g2</span><span class="p">,</span><span class="nx">err</span><span class="o">:=</span><span class="nx">strconv</span><span class="p">.</span><span class="nx">ParseInt</span><span class="p">(</span><span class="nx">getBank2</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">getBank2</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">)</span>
       <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">{</span>
           <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
           <span class="c1">// نمایش خطا برای خطا یابی</span>
       <span class="p">}</span>
       <span class="c1">// اگر تعداد افراد فعال داخل صف از کل افراد صف بیشتر شد صف را حرکت نده</span>
       <span class="k">if</span> <span class="nx">g1</span><span class="o">&gt;=</span><span class="nx">g2</span> <span class="p">{</span>
           <span class="nx">Last_User</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT user_id from tbl_turn_number WHERE bank_id=&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">bankId</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; ORDER BY ID DESC LIMIT 1&quot;</span><span class="p">)</span>
           <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
               <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
               <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
               <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
           <span class="c1">// نمایش خطا برای خطا یابی</span>
           <span class="p">}</span>
           <span class="c1">// نمایش پیام در سرور فردی فعال در صف نیست</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">Last_User</span><span class="p">)</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;============&quot;</span><span class="p">)</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;||No Queue||&quot;</span><span class="p">)</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;============&quot;</span><span class="p">)</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;-------------------------------&quot;</span><span class="p">)</span>
           <span class="c1">// نمایش تعداد افراد فعال داخل صف</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;active_turns_number&quot;</span><span class="p">,</span><span class="nx">getBank</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">getBank</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
           <span class="c1">// نمایش تعداد افراد صف</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;turns_number&quot;</span><span class="p">,</span><span class="nx">getBank2</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">getBank2</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;-------------------------------&quot;</span><span class="p">)</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getBank</span><span class="p">)</span>
       <span class="p">}</span><span class="k">else</span><span class="p">{</span>
           <span class="kd">var</span> <span class="nx">q</span> <span class="p">=</span> <span class="nx">getBank</span><span class="p">[</span><span class="mi">25</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nx">getBank</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
           <span class="c1">// برای جدا کردن کد بانک مورد نظر از آرایه</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">q</span><span class="p">)</span>
       <span class="c1">// logical error only last id increment</span>
       <span class="nx">Last_User</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT user_id from tbl_turn_number WHERE bank_id=&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">bankId</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; ORDER BY ID DESC LIMIT 1&quot;</span><span class="p">)</span>
       <span class="c1">// query برای نشان دادن کد فرد که نوبت گرفته است با شرط اینکه کد بانک با مقدار ارسالی  به وبسرویس یکسان باشد</span>
       <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
           <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
           <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
           <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
           <span class="c1">// نمایش خطا برای خطا یابی</span>
       <span class="p">}</span>
       <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">Last_User</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">Last_User</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
       <span class="c1">// کد اخرین فرد داخل صف</span>

       <span class="c1">// 0 because in Up_Query addition +1</span>
       <span class="nx">Up_Query</span><span class="p">(</span><span class="s">&quot;UPDATE `tbl_user` set status=? WHERE user_id=&quot;</span><span class="o">+</span><span class="nx">Last_User</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">Last_User</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="s">&quot;0&quot;</span><span class="p">)</span>
       <span class="c1">// query برای به روز رسانی وضیعت آخرین نفر در جدول کاربران</span>
       <span class="nx">Up_Query</span><span class="p">(</span><span class="s">&quot;UPDATE `tbl_turn_number` set turn_status=? WHERE user_id=&quot;</span><span class="o">+</span><span class="nx">Last_User</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="nx">Last_User</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="s">&quot;0&quot;</span><span class="p">)</span>
       <span class="c1">// query برای به روز رسانی وضیعت آخرین نفر در جدول نوبت</span>
       <span class="nx">Up_Query</span><span class="p">(</span><span class="s">&quot;UPDATE `tbl_bank` set active_turns_number=? WHERE bank_id=&quot;</span><span class="o">+</span><span class="nx">vars</span><span class="p">[</span><span class="s">&quot;bankId&quot;</span><span class="p">],</span> <span class="nx">q</span><span class="p">)</span>
       <span class="c1">// query برای به روز رسانی تعداد افراد فعال داخل صف بانک با کد بانک در جدول بانک</span>
       <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getBank</span><span class="p">)</span>
       <span class="p">}</span>

   <span class="p">}</span>

<span class="nx">برای</span> <span class="nx">نشان</span> <span class="nx">دادن</span> <span class="nx">مشخصات</span> <span class="nx">فرد</span> <span class="nx">در</span> <span class="nx">بانک</span> <span class="nx">نوبت</span> <span class="nx">گرفته</span> <span class="nx">شده</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">ShowQueue</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ShowQueue()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="nx">vars</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
    <span class="c1">// برای گرفتن مقادیر ارسالی از متغیر r که توسط کتابخوانه mux به یک آرایه با اندیس های ارسالی تبدیل میشود</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
    <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
    <span class="c1">// bank id should be set by client</span>
    <span class="nx">getBank</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT * from tbl_turn_number WHERE user_id=&quot;</span> <span class="o">+</span> <span class="nx">vars</span><span class="p">[</span><span class="s">&quot;userId&quot;</span><span class="p">])</span>
    <span class="c1">// query برای نشان دادن مشخصات فرد نوبت گرفته با شرط اینکه کد فرد با مقدار ارسالی  به وبسرویس یکسان باشد</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
        <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getBank</span><span class="p">)</span>
    <span class="c1">// در نهایت خروجی مورد نظر چاپ شود</span>
<span class="p">}</span>
</pre></div>
</div>
<p>برای نمایش تعداد افراد فعال داخل صف</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">RunQueueShow</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;RunQueueShow()&quot;</span><span class="p">)</span>
    <span class="c1">// فهمیدن برنامه اینکه داخل تابع شده است</span>
    <span class="nx">vars</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
    <span class="c1">// برای گرفتن مقادیر ارسالی از متغیر r که توسط کتابخوانه mux به یک آرایه با اندیس های ارسالی تبدیل میشود</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json; charset=UTF-8&quot;</span><span class="p">)</span>
    <span class="c1">// برای مشخص کردن نوع خروجی وبسرویس که از نوع  json است</span>
    <span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
    <span class="c1">// و همجنین برای تایین موفق آمیز بودن عملیات</span>
    <span class="c1">// bank id should be set by client</span>
    <span class="nx">getBank</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">getJSON</span><span class="p">(</span><span class="s">&quot;SELECT active_turns_number from tbl_bank WHERE bank_id=&quot;</span> <span class="o">+</span> <span class="nx">vars</span><span class="p">[</span><span class="s">&quot;bankId&quot;</span><span class="p">])</span>
    <span class="c1">// query برای نشان دادن تعداد افراد فعال داخل صف با شرط اینکه کد بانک با مقدار ارسالی  به وبسرویس یکسان باشد</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
        <span class="c1">// چک کردن خروجی و در صورت خطا چاپ خطا</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">getBank</span><span class="p">)</span>
    <span class="c1">// در نهایت خروجی مورد نظر چاپ شود</span>
<span class="p">}</span>
</pre></div>
</div>
<p>تابعی برای فراخوانی توسط دیگر توابع</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// for add queue and update other queue</span>
<span class="kd">func</span> <span class="nx">Up_Query</span><span class="p">(</span><span class="nx">sqlString</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">turn_n</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">sql</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;mysql&quot;</span><span class="p">,</span> <span class="s">&quot;root:password@tcp(127.0.0.1:3306)/tr_db&quot;</span><span class="p">)</span>
    <span class="c1">//ایجاد ار ارتباط با پایگاه داده</span>
    <span class="c1">// insert</span>
    <span class="nx">stmt</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Prepare</span><span class="p">(</span><span class="nx">sqlString</span><span class="p">)</span>
    <span class="c1">// اجرای query با مقدار ارسال شده به تابع</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="c1">// چک کردن خطا در نتیجه</span>
    <span class="nx">i</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">ParseInt</span><span class="p">(</span><span class="nx">turn_n</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="c1">// تبدیل شماره صف به مقدار int</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// نمایش خطا برای خطا یابی</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stmt</span><span class="p">.</span><span class="nx">Exec</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1">// جلو بردن شماره صف با step ۱</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Duplicate Queue&quot;</span><span class="p">)</span>
        <span class="c1">// خطا: در گذشته شما نوبت گرفته اید</span>
    <span class="p">}</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="c1">// چک کردن خطا در نتیجه</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
    <span class="c1">// نمایش خروجی</span>
    <span class="cm">/*res, err := stmt.Exec(i + 1)</span>
<span class="cm">    checkErr(err)</span>
<span class="cm">    id, err := res.LastInsertId()</span>
<span class="cm">    // شماره آخرین فرد</span>
<span class="cm">    checkErr(err)*/</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="repo-go">
<h3>repo.go<a class="headerlink" href="#repo-go" title="Permalink to this headline">¶</a></h3>
<p>چون در فولدر  router هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">route</span>
</pre></div>
</div>
<p>کتابخوانه های فراخوانی شده هم شامل این مقادیر است</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;crypto/md5&quot;</span>
    <span class="s">&quot;database/sql&quot;</span>
    <span class="s">&quot;encoding/hex&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="nx">_</span> <span class="s">&quot;github.com/go-sql-driver/mysql&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>تابعی برای ساخت هش md5</p>
<p>برای اطلاعات بیشتر</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/2377881/how-to-get-a-md5-hash-from-a-string-in-go">https://stackoverflow.com/questions/2377881/how-to-get-a-md5-hash-from-a-string-in-go</a></p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// for generate token</span>
<span class="kd">func</span> <span class="nx">GetMD5Hash</span><span class="p">(</span><span class="nx">text</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="nx">hasher</span> <span class="o">:=</span> <span class="nx">md5</span><span class="p">.</span><span class="nx">New</span><span class="p">()</span>
    <span class="nx">hasher</span><span class="p">.</span><span class="nx">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">text</span><span class="p">))</span>
    <span class="k">return</span> <span class="nx">hex</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">(</span><span class="nx">hasher</span><span class="p">.</span><span class="nx">Sum</span><span class="p">(</span><span class="kc">nil</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
<p>تابعی برای ثبت کاربر که در فایل handlers.go استفاده میشود</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">RepoCreateUser</span><span class="p">(</span><span class="nx">t</span> <span class="nx">Todo</span><span class="p">)</span> <span class="nx">Todo</span> <span class="p">{</span>
    <span class="c1">// بر قرار ارتباط با پایگاه داده</span>
    <span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">sql</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;mysql&quot;</span><span class="p">,</span> <span class="s">&quot;root:password@tcp(127.0.0.1:3306)/tr_db&quot;</span><span class="p">)</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="c1">// چک کردن خطا در نتیجه</span>
    <span class="c1">// insert</span>
    <span class="nx">stmt</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Prepare</span><span class="p">(</span><span class="s">&quot;INSERT INTO tbl_user SET username=?,password=?,token=?,status=0,email=?,phone_number=?,turn_number=0&quot;</span><span class="p">)</span>
    <span class="c1">// query برای نثبت در جدول کاربر</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>



    <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stmt</span><span class="p">.</span><span class="nx">Exec</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Password</span><span class="p">,</span> <span class="nx">GetMD5Hash</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">Phone</span><span class="p">),</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Email</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Phone</span><span class="p">)</span>
    <span class="c1">// جایگذاری مقادیر ارسالی به وبسرویس توسط ساختار از پیش نوشته شده</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">LastInsertId</span><span class="p">()</span>
    <span class="c1">// کد آخرین فرد</span>

    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
    <span class="c1">// چاپ کد آخرین فرد</span>
    <span class="nx">currentId</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">// جلو بردن کد فرد جاری در سیستم</span>

    <span class="nx">todos</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">todos</span><span class="p">,</span> <span class="nx">t</span><span class="p">)</span>
    <span class="c1">// اضافه کردن مقدار نهایی ساختار به ساختار از پیش نوشته شده</span>
    <span class="k">return</span> <span class="nx">t</span>
    <span class="c1">// برگرداندن ساختار با مقادیر صحیح</span>
<span class="p">}</span>
</pre></div>
</div>
<p>تابعی برای ثبت بانک که در فایل handlers.go استفاده میشود</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">RepoCreateBank</span><span class="p">(</span><span class="nx">b</span> <span class="nx">Bank</span><span class="p">)</span> <span class="nx">Bank</span> <span class="p">{</span>
    <span class="c1">// بر قرار ارتباط با پایگاه داده</span>
    <span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">sql</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;mysql&quot;</span><span class="p">,</span> <span class="s">&quot;root:password@tcp(127.0.0.1:3306)/tr_db&quot;</span><span class="p">)</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="c1">// چک کردن خطا در نتیجه</span>

    <span class="c1">// insert</span>
    <span class="nx">stmt</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">Prepare</span><span class="p">(</span><span class="s">&quot;INSERT INTO tbl_bank SET name=?,branch=?,code=?,address=?,x=?,y=?,turns_number=1,active_turns_number=1&quot;</span><span class="p">)</span>
    <span class="c1">// query برای نثبت در جدول بانک</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stmt</span><span class="p">.</span><span class="nx">Exec</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">Branch</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">Code</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">Address</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">X</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">Y</span><span class="p">)</span>
    <span class="c1">// جایگذاری مقادیر ارسالی به وبسرویس توسط ساختار از پیش نوشته شده</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">LastInsertId</span><span class="p">()</span>
    <span class="c1">// کد آخرین بانک</span>
    <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
    <span class="c1">// چاپ کد آخرین بانک</span>
    <span class="k">return</span> <span class="nx">b</span>
    <span class="c1">// برگرداندن ساختار با مقادیر صحیح</span>

<span class="p">}</span>
</pre></div>
</div>
<p>تابعی برای خطایابی دقیق تر</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// پارامتری از نوع اررور میگیرد</span>
<span class="kd">func</span> <span class="nx">checkErr</span><span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
        <span class="c1">// در صورت خطا چاپ خطا برای خطایابی</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="router-go">
<h3>router.go<a class="headerlink" href="#router-go" title="Permalink to this headline">¶</a></h3>
<p>چون در فولدر  router هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">route</span>
</pre></div>
</div>
<p>کتابخوانه های فراخوانی شده هم شامل این مقادیر است</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span>   <span class="kn">import</span> <span class="p">(</span>
       <span class="s">&quot;github.com/gorilla/mux&quot;</span>
       <span class="s">&quot;gotest/log&quot;</span>
       <span class="s">&quot;net/http&quot;</span>
   <span class="p">)</span>

<span class="nx">این</span> <span class="nx">تابع</span> <span class="nx">توسط</span> <span class="nx">تابع</span> <span class="nx">اصلی</span> <span class="nx">برنامه</span> <span class="nx">به</span> <span class="nx">نام</span> <span class="nx">main</span> <span class="nx">موجود</span> <span class="nx">در</span> <span class="nx">فایل</span> <span class="nx">main</span><span class="p">.</span><span class="k">go</span> <span class="nx">اجرا</span> <span class="nx">میشود</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">NewRouter</span><span class="p">()</span> <span class="o">*</span><span class="nx">mux</span><span class="p">.</span><span class="nx">Router</span> <span class="p">{</span>

    <span class="nx">router</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">NewRouter</span><span class="p">().</span><span class="nx">StrictSlash</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">route</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">routes</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">handler</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Handler</span>
        <span class="nx">handler</span> <span class="p">=</span> <span class="nx">route</span><span class="p">.</span><span class="nx">HandlerFunc</span>
        <span class="c1">// لاگ زدن برای شناسایی درخواست ها</span>
        <span class="nx">handler</span> <span class="p">=</span> <span class="nx">log</span><span class="p">.</span><span class="nx">Logger</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">route</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>


        <span class="nx">router</span><span class="p">.</span>
            <span class="c1">// بر اساس متد درخواست مثلا POST</span>
            <span class="nx">Methods</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">Method</span><span class="p">).</span>
            <span class="c1">// بر اساس مسیر درخواست شده</span>
            <span class="nx">Path</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">Pattern</span><span class="p">).</span>
            <span class="c1">// نام مسیر درست شده</span>
            <span class="nx">Name</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">Name</span><span class="p">).</span>
            <span class="c1">// تابعی که درخواست را کنترل  میکند</span>
            <span class="nx">Handler</span><span class="p">(</span><span class="nx">handler</span><span class="p">)</span>

    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">router</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="routes-go">
<h3>routes.go<a class="headerlink" href="#routes-go" title="Permalink to this headline">¶</a></h3>
<p>چون در فولدر  router هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">route</span>
</pre></div>
</div>
<p>کتابخوانه های فراخوانی شده هم شامل این مقادیر است</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="s">&quot;net/http&quot;</span>
</pre></div>
</div>
<p>ساخت ساختار مشخص برای نوشتن و هدایت مسر ها</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Route</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Name</span>        <span class="kt">string</span>
    <span class="nx">Method</span>      <span class="kt">string</span>
    <span class="nx">Pattern</span>     <span class="kt">string</span>
    <span class="nx">HandlerFunc</span> <span class="nx">http</span><span class="p">.</span><span class="nx">HandlerFunc</span>
<span class="p">}</span>
</pre></div>
</div>
<p>تمامی آدرس های نوشته شده</p>
</div>
<div class="section" id="todo-go">
<h3>todo.go<a class="headerlink" href="#todo-go" title="Permalink to this headline">¶</a></h3>
<p>چون در فولدر  router هستیم پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">route</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// ساختار نوشته شده برای کاربران که شامل مقادیری برای درج در پایگاه داده است</span>
<span class="kd">type</span> <span class="nx">Todo</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// فیلد id که از نوع int است و در خروجی json با نام id وجود دارد و در کد با نام Id  به آن دسترسی داریم</span>
    <span class="nx">Id</span>       <span class="kt">int</span>       <span class="s">`json:&quot;id&quot;`</span>
    <span class="c1">// فیلد name که از نوع string است و در خروجی json با نام name وجود دارد و در کد با نام Name  به آن دسترسی داریم</span>
    <span class="nx">Name</span>     <span class="kt">string</span>    <span class="s">`json:&quot;name&quot;`</span>
    <span class="c1">// فیلد password که از نوع string است و در خروجی json با نام password وجود دارد و در کد با نام Password  به آن دسترسی داریم</span>
    <span class="nx">Password</span> <span class="kt">string</span>    <span class="s">`json:&quot;password&quot;`</span>
    <span class="c1">// فیلد email که از نوع string است و در خروجی json با نام email وجود دارد و در کد با نام Email  به آن دسترسی داریم</span>
    <span class="nx">Email</span>    <span class="kt">string</span>    <span class="s">`json:&quot;email&quot;`</span>
    <span class="c1">// فیلد phone_number که از نوع string است و در خروجی json با نام phone_number وجود دارد و در کد با نام Phone  به آن دسترسی داریم</span>
    <span class="nx">Phone</span>    <span class="kt">string</span>    <span class="s">`json:&quot;phone_number&quot;`</span>
<span class="p">}</span>

<span class="c1">// ساختار نوشته شده برای بانک ها که شامل مقادیری برای درج در پایگاه داده است</span>
<span class="kd">type</span> <span class="nx">Bank</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// فیلد id که از نوع int است و در خروجی json با نام id وجود دارد و در کد با نام Id  به آن دسترسی داریم</span>
    <span class="nx">Id</span>                  <span class="kt">int</span>    <span class="s">`json:&quot;id&quot;`</span>
    <span class="c1">// فیلد name که از نوع string است و در خروجی json با نام name وجود دارد و در کد با نام Name  به آن دسترسی داریم</span>
    <span class="nx">Name</span>                <span class="kt">string</span> <span class="s">`json:&quot;name&quot;`</span>
    <span class="c1">// فیلد branch که از نوع string است و در خروجی json با نام branch وجود دارد و در کد با نام Branch  به آن دسترسی داریم</span>
    <span class="nx">Branch</span>              <span class="kt">string</span> <span class="s">`json:&quot;branch&quot;`</span>
    <span class="c1">// فیلد code که از نوع string است و در خروجی json با نام code وجود دارد و در کد با نام Code  به آن دسترسی داریم</span>
    <span class="nx">Code</span>                <span class="kt">string</span> <span class="s">`json:&quot;code&quot;`</span>
    <span class="c1">// فیلد address که از نوع string است و در خروجی json با نام address وجود دارد و در کد با نام Address  به آن دسترسی داریم</span>
    <span class="nx">Address</span>             <span class="kt">string</span> <span class="s">`json:&quot;address&quot;`</span>
    <span class="c1">// فیلد x که از نوع string است و در خروجی json با نام x وجود دارد و در کد با نام X  به آن دسترسی داریم</span>
    <span class="nx">X</span>                   <span class="kt">string</span> <span class="s">`json:&quot;x&quot;`</span>
    <span class="c1">// فیلد y که از نوع string است و در خروجی json با نام y وجود دارد و در کد با نام Y  به آن دسترسی داریم</span>
    <span class="nx">Y</span>                   <span class="kt">string</span> <span class="s">`json:&quot;y&quot;`</span>
    <span class="c1">// فیلد turns_number که از نوع string است و در خروجی json با نام turns_number وجود دارد و در کد با نام Turns_number  به آن دسترسی داریم</span>
    <span class="nx">Turns_number</span>        <span class="kt">string</span> <span class="s">`json:&quot;turns_number&quot;`</span>
    <span class="c1">// فیلد active_turns_number که از نوع string است و در خروجی json با نام active_turns_number وجود دارد و در کد با نام Active_turns_number  به آن دسترسی داریم</span>
    <span class="nx">Active_turns_number</span> <span class="kt">string</span> <span class="s">`json:&quot;active_turns_number&quot;`</span>
<span class="p">}</span>

<span class="c1">// گرفتن نمونه برای ثبت کاربر</span>
<span class="kd">type</span> <span class="nx">Todos</span> <span class="p">[]</span><span class="nx">Todo</span>
<span class="c1">// گرفتن نمونه برای ثبت بانک</span>
<span class="kd">type</span> <span class="nx">Banks</span> <span class="p">[]</span><span class="nx">Bank</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="main-go">
<h2>main.go<a class="headerlink" href="#main-go" title="Permalink to this headline">¶</a></h2>
<p>چون برنامه توسط تابع و بسته main اجرا میشود پس داریم</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>
</pre></div>
</div>
<p>کتابخوانه های فراخوانی شده هم شامل این مقادیر است</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;gotest/route&quot;</span>
    <span class="s">&quot;log&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// گرفتن نمونه از مسیر های تعین شده</span>
    <span class="nx">router</span> <span class="o">:=</span> <span class="nx">route</span><span class="p">.</span><span class="nx">NewRouter</span><span class="p">()</span>
    <span class="c1">// اجرا برنامه در پورت 8088 متنظر درخواست به مسیر ها</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">&quot;:8088&quot;</span><span class="p">,</span> <span class="nx">router</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gotest-webapp/webapp-overview.html" class="btn btn-neutral float-right" title="نوبت دهی از طریق وبسایت چگونه است ؟" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="server-overview2.html" class="btn btn-neutral" title="بررسی سرور قسمت ۲" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      Last updated on Jul 09, 2018.
    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

<script type="text/javascript">
    $(document).ready(function () {
    $(".icon1").click(function () {
      $(".mobilenav").fadeToggle(500);
      $(".top-menu").toggleClass("top-animate");
      $(".mid-menu").toggleClass("mid-animate");
      $(".bottom-menu").toggleClass("bottom-animate");
    });
  });
</script>

</body>
</html>