<!DOCTYPE html5>
<html>
<head>
	<title>log up</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css">
<script src='https://www.google.com/recaptcha/api.js'></script>
    <link href='http://www.fontonline.ir/css/BMitra.css' rel='stylesheet' type='text/css'>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<style type="text/css">
	*{
	  font-family:'BMitra',Sans-Serif!important;
	  font-size:14px;
	 }
	 h2{
	 	font-size: 18px !important;
	 }
	#loadingDiv{
		position: absolute;
		left: 50%;
		top: 50%;
	}
	#error_success{
		text-shadow: 1px 1px 1px black;
	}
	#success{
		margin: -4% 0% -16% 0%;
		text-shadow: 1px 1px 1px black;
	}
	#hidden_success{
		margin: -10% 0% -10% 0%;
		text-shadow: 1px 1px 1px black;
	}
</style>

    <link rel="stylesheet" type="text/css" href="gotest.logup/gotest.logup.css">



<script>
	
(function() {
  $(document).ready(function() {

    $('#navbox-trigger').click(function() {
      return $('#top-bar').toggleClass('navbox-open');
    });
    return $(document).on('click', function(e) {
      var $target, boxClicked, triggerClicked;
      $target = $(e.target);
      boxClicked = $target.closest('.navbox').length;
      triggerClicked = $target.closest('#navbox-trigger').length;
      if (!boxClicked && !triggerClicked) {
        return $('#top-bar').removeClass('navbox-open');
      }
    });




  });

}).call(this);

function isEmail(email) {
  var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  return regex.test(email);
}

function setCookie(cname, cvalue) {
    //var d = new Date();
    //d.setTime(d.getTime() + (exdays*24*60*60*1000));
    //var expires = "expires="+ d.toUTCString();
    document.cookie = "username="+ cname + ";path=/";
    document.cookie = "password="+ cvalue + ";path=/";
}


  function send() {
  	var response = grecaptcha.getResponse();


  	var v = grecaptcha.getResponse();
    if(v.length == 0)
    {
        $("#Error").css("display", "block");
        return false;
    }
    else
    {
    	// Check Text is not Empty
    	$("#Error").css("display", "none");
        var txtName = $("#name").val();
        var txtPassword = $("#password").val();
        var txtEmail = $("#email").val();
        var txtPhone = $("#phone_number").val();
        if(txtName != "" && txtPhone != ""){
        	$("#ErrorName").css("display", "none");
        	$("#ErrorPhone").css("display", "none");
        	$("#ErrorEmail").css("display", "none");
        	if(txtEmail !=""){
        		if(isEmail(txtEmail)){
        			var person = {
		          	  name: txtName,
		          	  phone_number:txtPhone,
		          	  email:txtEmail,
		          	  password:txtPhone,
		          	  turn_number:0,
		          	  status:0
		       		}
        		}else{
        			$("#ErrorEmail").css("display", "block");
        			return;
        		}
        		
	       	}else if(txtPassword !=""){
	       		var person = {
		         	  name: txtName,
		          	  phone_number:txtPhone,
		          	  email:"noEmail@email.com",
		          	  password:txtPassword,
		          	  turn_number:0,
		          	  status:0
		       		 }
	       	}else if(txtEmail !="" && txtPassword !=""){
	       		var person = {
		         	  name: txtName,
		          	  phone_number:txtPhone,
		          	  email:txtEmail,
		          	  password:txtPassword,
		          	  turn_number:0,
		          	  status:0
		       		 }
	       	}else{
	       		var person = {
	          	  name: txtName,
	          	  phone_number:txtPhone,
	          	  email:"noEmail@email.com",
	          	  password:txtPhone,
	          	  turn_number:0,
	          	  status:0
	       		 }
	       	}
        	
        }else{
        	// important txtName and txtPhone not Empty
        	if(txtName == ""){
        		$("#ErrorName").css("display", "block");
        		return;	
        	}else if(txtPhone == ""){
        		$("#ErrorPhone").css("display", "block");
        		return;
        	}else{
	        	$("#ErrorName").css("display", "block");
				$("#ErrorPhone").css("display", "block");
	        	return;
        	}
			
        }
       
        
        
		$('#loadingDiv').show();



        $.ajax({
            url: 'http://gotest.com:8088/users',
            type: 'post',
            dataType: 'json',
            crossDomain: true,
            success: function (data) {
                // TODO
                console.log("Success Add User");
                setCookie(txtName,txtPhone);
                $('#loadingDiv').hide();
                $('#error_success').hide();
                $('#hidden_success').hide();
                $('#success').show();
                window.location.replace("http://gotest.com/gotest/index.html");
            },
            error: function (response) {
	           //Handle error
	           console.log("Error Add User");
	           $("#loadingDiv").hide();
	           $('#error_success').show();
			},
            data: JSON.stringify(person)
        });

       
    }
	



  	
    }


</script>

</head>
<body>
  <!--start top menu-->

<div class="top-bar" id="top-bar">
  <div class="bar">
    <button class="navbox-trigger" id="navbox-trigger"><i class="fa fa-lg fa-th"></i></button>
  </div>
  <div class="navbox">
        
        <div class="navbox-tiles">
          <a class="tile" href="index.html" style="width: 100%"><div class="icon"><i class="fa fa-home"></i></div><span class="title">Home</span></a>
        </div>
  </div>
</div>
  <!--end top menu-->
<div class="signup" style="margin-top: 13px;">

		<ul class="singup-list">
			<li><div id="error_success" style="display: none;color: red;text-align: center;font-size: 50px;">لطفا اطلاعات خود را بررسی کنید</div></li><br><br>
			<li><div id="success" style="display: none;color: green;text-align: center;font-size: 50px;">با موفقیت ثبت شد</div></li><br><br><br><br>
			<li><div id="hidden_success" style="color: #3498db;text-align: center;font-size: 50px;">ثبت نام</div></li><br><br><br><br><br>
			<h2 id="ErrorName" style="display: none;color: red;fon">لطفا نام کاربری خود را وارد کنید</h2>
			<br>
			<li class="signup-item">
				<input id="name" type="text" placeholder="Abc123" class="signup-input" required />
				<label for="" class="signup-label">نام کاربری</label>
			</li>
			<!--<li class="signup-item">
				<input id="password" type="password" placeholder="*******" class="signup-input">
				<label for="" class="signup-label">کلمه عبور</label>
			</li>-->
			<h2 id="ErrorEmail" style="display: none;color: red;">لطفا پست الکترونیکی معتبر وارد کنید</h2>
			<br>
			<li class="signup-item">
				<input id="email" type="email" placeholder="user@gmail.com" class="signup-input">
				<label for="" class="signup-label">پست الکترونیکی</label>
			</li>
				<h2 id="ErrorPhone" style="display: none;color: red;">لطفا شماره تلفن خود را وارد کنید</h2>
				<br>
			<li class="signup-item">
				<input id="phone_number" type="text" placeholder="093------44" class="signup-input" required />
				<label for="" class="signup-label">شماره تلفن</label>
			</li>
			<!--<li class="signup-item">
				<div class="signup-select">
					<label for="" class="signup-label">Country</label>
					<span class="signup-select-text">Bulgaria</span>
					<div class="signup-select-menu">
						<ul>
							<li class="singup-select__list-item">
								<a href="#" class="signup-select__item">Europe</a>
							</li>
							<li class="singup-select__list-item">
								<a href="#" class="signup-select__item">Australia</a>
							</li>
							<li class="singup-select__list-item">
								<a href="#" class="signup-select__item">Asia</a>
							</li>
						</ul>
					</div>
				</div>
			</li>-->
			<span id="captchaError" style="margin-left:100px;color:red" >
				<h2 id="Error" style="display: none;">لطفا کد امنیتی را انتخاب کنید</h2>
			</span>
			<br>
			<div class="g-recaptcha" id="rcaptcha" data-sitekey="6Lc3SyoUAAAAAKNzXZwNcQHWf7nABSV1PyqgcE-0"></div><br><br>
			
			<li class="signup-item">
				<button onclick="send()" id="submit" class="signup-submit">ارسال</button>
				
			</li>
		</ul>
	


</div>

<div id="loadingDiv" style="display: none;">
<img src="ajax-loader.gif">
</div>

</body>
</html>